<div class="tour-container">
    <div class="map-checkpoint-container">
        <div class="map">
            <xp-map></xp-map>
        </div>
        
        <div class="first-checkpoint">
            <p class="checkpoint-title">Starting checkpoint: {{tour.checkpoint.name}}</p>
            <hr class="hr-checkpoint">
            <label>{{tour.checkpoint.description}}</label>
        </div>
    </div>
    <div class="tour-details">
        <div class="tour-description">
        
        <p>{{tour.name}}</p>
        
        <div class="tag-buttons">
            <button *ngFor="let tag of tour.tags" class="tag-button">{{tag}}</button>
        </div>

        <p class="subtitle">Information</p>
        <hr>

        <table id="tour-details-table">
            <tr>
                <th>Description:</th>
                <td>{{tour.description}}</td>
            </tr>
            <tr>
                <th>Price:</th>
                <td>{{tour.price}} <span style="font-size: larger;">ðŸ’°</span></td>
            </tr>
            <tr>
                <th>Difficulty:</th>
                <td>{{tour.demandignessLevel}}</td>
            </tr>
            <tr *ngFor="let tt of tour.tourTime">
                <th>{{ getFormattedTransportation(tt.transportation) }}</th>
                <td>{{(tt.distance/1000).toFixed(2)}} km ({{(tt.timeInSeconds/3600).toFixed(0)}} h {{((tt.timeInSeconds%3600)/60).toFixed(0)}} min)</td>
            </tr>           
        </table>
    
        <div *ngIf="tour.equipment.length > 0">
            <p class="subtitle">Required equipment</p>
            <hr>
        
            <div class="scrollable-table">
                <table>
                    <thead>
                        <th>Name</th>
                        <th>Description</th>
                    </thead>
                    
                    <tbody>
                        <tr *ngFor="let e of tour.equipment">
                            <td>{{e.name}}</td>
                            <td>{{e.description}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
       
    <p class="subtitle">Ratings</p>
    <div>
        <table>
            <tbody>
                <tr *ngFor="let e of tour.tourRating" >
                    <td>
                        <div>
                            <span>
                                <div><span><span>Comment:</span>{{e.comment}}</span></div>
                                <div><span><span>Rating:</span>{{e.rating}}</span></div>
                            </span>
                            <span>
                                <div><span><span>Creation Date:</span>{{ e.creationDate | date:'dd/MM/yyyy HH:mm' }}</span></div>
                                <div><span><span>Creation Date:</span>{{ e.creationDate | date:'dd/MM/yyyy HH:mm' }}</span></div>
                            </span>
                            <button *ngIf="isTouristRating(e)" (click)="editRating(e)" color="primary" mat-icon-button>
                                <mat-icon>edit</mat-icon>
                            </button> 
                        </div>
                    </td>
                </tr>
            </tbody>
      
    </table>
    <div>
        <p>Average Rating: {{ tourAvarageRating | number:'1.2-2' }}</p>
    </div>
    </div>
        <div class="routingButton">
            <div>
                <button mat-raised-button class="button nav" (click)="onBack()">All tours</button>
            </div>
            <div>
                <button mat-raised-button class="button shop" (click)="rateTour(tour)">Rate</button>
            </div>
            <div>
                <button mat-raised-button class="button shop" (click)="onAddToCart(tour)" [disabled]="isTourInCart" [ngStyle]="{ 'background-color': buttonColor }">Add to cartðŸ›’</button>
            </div>
        </div>
        </div>
        <div class="checkpoint-image">
            <img [src]="tour.checkpoint.pictures[0]">
        </div>
    </div>
</div>

